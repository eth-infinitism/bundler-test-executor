version: '2'

services:
  bundler:
    image: ghcr.io/vid201/silius:latest
    command: 
      - bundler
      - --eth-client-address
      - http://geth-dev:8545
      - --datadir
      - data/silius
      - --mnemonic-file
      - /root/${BUNDLER_ACCOUNT}
      - --beneficiary
      - 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 
      - --entry-points 
      - 0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789 
      - --http 
      - --http.addr
      - 0.0.0.0
      - --http.port
      - "3000"
      - --http.api
      - eth,debug,web3
    ports: [ '3000:3000' ]
    volumes:
      - ./keys:/root
    depends_on: [ geth-dev ]

  fund-signer:
    image: ethereum/client-go:release-1.10
    entrypoint: 'geth --exec "eth.sendTransaction({from: eth.accounts[0], to: \"0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\", value: web3.toWei(10000, \"ether\")})" attach http://geth-dev:8545'
    depends_on:
      geth-dev:
        condition: service_started

  geth-dev:
    build: geth-dev
    ports: [ '8545:8545' ]
